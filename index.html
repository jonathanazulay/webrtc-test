<!doctype html>
<html>
<head>
	<title></title>
	<style>
		body, html {
			margin: 0;
			height: 100%;
			background: rgb(20,20,20);
			color: rgb(230,230,230);
			font-family: sans-serif;
			font-size: 11px;
		}
		video,div {
			margin: 0;
			padding: 0;
		}
		div {
			padding: 50px;
		}
		#inputs {
			margin: 10px;
		}
	</style>
	<script type="text/javascript" src="adapter.js"></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/socket.io/0.9.5/socket.io.min.js"></script>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
	<script src="webRTCClient.js"></script>
	<script type="text/javascript">
		var connection;
		function connect() {
			connection = new app.webRTC('ws://'+window.location.hostname+':12345');
			connection.connect($('input[name=myId]').val(), $('input[name=partnerId]').val());
		}
		function addStream() {
			connection.addStream({video: true, audio: false});
		}
		$(document).ready(function() {
			$('input[type=button]').click(function() {
				if(this.value === 'Add stream') {
					if(!connection) {
						this.disabled = false;
						this.value = 'Connect';
						return;
					}
					addStream();
					this.disabled = true;
				}
				else {
					connect();
					this.disabled = true;
					this.value='Hang on...';
					var that = this;
					setTimeout(function() {
						that.disabled = false;
						that.value = 'Add stream';
					}, 2000);
				}
			});
			$('input[name=myId]').val(Math.random().toString(36).substring(2,3));
		});
	</script>
</head>
<body>
	<section id="inputs">
		Your id (reload page if not unique): <input name="myId" type="text" value="user1" disabled />
		<input name="partnerId" type="text" value="user2" />
		<input type="button" value="Connect..." />
	</section>
	<div style="position:absolute;top:0;bottom:0;left:0;right:50%;margin-top:30px;"><video id="local" style="width:100%;height:100%;" autoplay></video></div>
	<div style="position:absolute;top:0;bottom:0;right:0;left:50%;margin-top:30px;"><video id="remote" style="width:100%;height:100%;" autoplay></video></div>
</body>
</html>